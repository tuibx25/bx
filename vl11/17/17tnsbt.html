<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Tập Trắc Nghiệm - Bài 17 (SBT)</title>
    <link rel="icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/tuibx25/images/bx/favicon.ico">
    <!-- Thêm MathJax để hiển thị công thức toán -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- Ngăn chặn các hành vi không mong muốn (giống 17tlsbt) -->
    <script>
        // Ngăn chặn menu chuột phải
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
        
        // Ngăn chặn phím tắt (Ctrl+U, Ctrl+S, Ctrl+P, F12, etc.)
        document.addEventListener('keydown', function(e) {
            // Ctrl+U (View Source)
            if (e.ctrlKey && e.keyCode === 85) e.preventDefault();
            // Ctrl+S (Save)
            if (e.ctrlKey && e.keyCode === 83) e.preventDefault();
            // Ctrl+P (Print)
            if (e.ctrlKey && e.keyCode === 80) e.preventDefault();
            // F12 (Developer Tools)
            if (e.keyCode === 123) e.preventDefault();
            // Ctrl+Shift+I (Developer Tools)
            if (e.ctrlKey && e.shiftKey && e.keyCode === 73) e.preventDefault();
            // Ctrl+Shift+J (Console)
            if (e.ctrlKey && e.shiftKey && e.keyCode === 74) e.preventDefault();
            // Ctrl+Shift+C (Inspector)
            if (e.ctrlKey && e.shiftKey && e.keyCode === 67) e.preventDefault();
        });
        
        // Ngăn chặn kéo thả hình ảnh
        document.addEventListener('dragstart', function(e) {
            if (e.target.tagName === 'IMG') e.preventDefault();
        });
        
        // Ngăn chặn sao chép văn bản
        document.addEventListener('copy', function(e) {
            e.preventDefault();
            alert('Không cho phép sao chép nội dung!');
        });
        
        // Ngăn chặn cắt
        document.addEventListener('cut', function(e) {
            e.preventDefault();
        });
        
        // Ngăn chặn dán
        document.addEventListener('paste', function(e) {
            e.preventDefault();
        });
        
        // Ngăn chặn chọn văn bản
        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
        });
    </script>
    
    <style>
        /* CSS để chống in ấn (giống 17tlsbt) */
        @media print {
            * {
                display: none !important;
            }
            body:before {
                content: "Không cho phép in trang này!";
                display: block !important;
                font-size: 24px;
                text-align: center;
                margin-top: 100px;
            }
        }
        
        :root {
            --primary-brown: #8B4513;
            --secondary-brown: #A0522D;
            --light-brown: #D2B48C;
            --dark-brown: #654321;
            --neutral-beige: #F5F5DC;
            --neutral-tan: #D2B48C;
            --text-dark: #333333;
            --text-light: #5D4037;
            --correct-color: #2E7D32;
            --incorrect-color: #C62828;
            --border-radius: 8px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-user-select: none; /* Safari */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* IE10+/Edge */
            user-select: none; /* Standard */
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--neutral-beige);
            color: var(--text-dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Watermark nền (giống 17tlsbt) */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: repeat;
            background-position: center;
            background-size: 400px 400px;
            opacity: 0.08; /* Độ mờ của watermark */
            z-index: -1;
            pointer-events: none;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.92);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            flex-grow: 1;
            position: relative;
            z-index: 1;
        }
        
        /* Header */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-brown);
        }
        
        h1 {
            color: var(--primary-brown);
            margin-bottom: 10px;
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .subtitle {
            color: var(--secondary-brown);
            font-size: 1.3rem;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .chapter-info {
            color: var(--dark-brown);
            font-size: 1.1rem;
            margin-top: 10px;
        }
        
        /* Hướng dẫn */
        .instructions {
            background-color: #f9f3e9;
            border: 1px solid var(--light-brown);
            padding: 20px;
            margin-bottom: 30px;
            border-radius: var(--border-radius);
        }
        
        .instructions h3 {
            color: var(--dark-brown);
            margin-bottom: 12px;
            font-size: 1.4rem;
        }
        
        .instructions p {
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        /* Câu hỏi */
        .quiz-container {
            margin-bottom: 40px;
        }
        
        .question {
            background-color: #faf7f2;
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid var(--secondary-brown);
            position: relative;
            overflow: hidden;
        }
        
        /* Watermark nhẹ trên từng câu hỏi (giống 17tlsbt) */
        .question::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300px;
            height: 300px;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: no-repeat;
            background-position: center;
            background-size: contain;
            opacity: 0.03;
            transform: translate(-50%, -50%);
            z-index: 0;
            pointer-events: none;
        }
        
        .question:hover {
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
        }
        
        .question-header {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        
        .question-number {
            display: inline-block;
            background-color: var(--primary-brown);
            color: white;
            width: 40px;
            height: 40px;
            text-align: center;
            line-height: 40px;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            font-size: 1.2rem;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
        }
        
        .question-text {
            font-weight: 600;
            font-size: 1.5rem;
            color: var(--text-dark);
            padding-top: 5px;
            position: relative;
            z-index: 1;
        }
        
        /* Tùy chọn */
        .options {
            margin-left: 10px;
            position: relative;
            z-index: 1;
        }
        
        .option {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #e0d6c8;
            position: relative;
            z-index: 1;
        }
        
        .option:hover {
            background-color: #f0ebe1;
            transform: translateY(-2px);
        }
        
        .option.selected {
            background-color: #e8dfd1;
            border-color: var(--secondary-brown);
        }
        
        .option.correct {
            background-color: #e8f5e9;
            border-color: var(--correct-color);
        }
        
        .option.incorrect {
            background-color: #ffebee;
            border-color: var(--incorrect-color);
        }
        
        .option-letter {
            display: inline-block;
            width: 36px;
            height: 36px;
            background-color: var(--light-brown);
            color: var(--dark-brown);
            text-align: center;
            line-height: 36px;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            font-size: 1.1rem;
            flex-shrink: 0;
        }
        
        .selected .option-letter {
            background-color: var(--secondary-brown);
            color: white;
        }
        
        .correct .option-letter {
            background-color: var(--correct-color);
            color: white;
        }
        
        .incorrect .option-letter {
            background-color: var(--incorrect-color);
            color: white;
        }
        
        .option-text {
            padding-top: 5px;
            font-size: 1.5rem;
            color: var(--text-light);
        }
        
        /* Giải thích */
        .explanation {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
            margin-top: 0;
            background-color: #f9f7f3;
            border-radius: var(--border-radius);
            position: relative;
            z-index: 1;
        }
        
        .explanation.show {
            max-height: 500px;
            margin-top: 20px;
            padding: 20px;
        }
        
        .explanation h4 {
            color: var(--dark-brown);
            margin-bottom: 15px;
            font-size: 1.3rem;
            position: relative;
            z-index: 1;
        }
        
        .explanation p {
            font-size: 1.5rem;
            color: var(--text-light);
            line-height: 1.7;
            position: relative;
            z-index: 1;
        }
        
        /* Công thức toán học */
        .math-formula {
            font-family: "Times New Roman", Times, serif;
            font-size: 1.4rem;
            background-color: #f8f8f8;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            margin: 5px 0;
        }
        
        mjx-container {
            display: inline-block;
            margin: 0 2px;
            vertical-align: middle;
        }
        
        /* Điều khiển */
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }
        
        button {
            padding: 18px 35px;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.3rem;
            min-width: 200px;
            position: relative;
            z-index: 1;
        }
        
        #checkBtn {
            background-color: var(--primary-brown);
            color: white;
        }
        
        #checkBtn:hover {
            background-color: var(--dark-brown);
            transform: translateY(-3px);
        }
        
        #resetBtn {
            background-color: var(--light-brown);
            color: var(--dark-brown);
        }
        
        #resetBtn:hover {
            background-color: #c9b18c;
            transform: translateY(-3px);
        }
        
        /* Kết quả */
        .results {
            margin-top: 40px;
            padding: 30px;
            background-color: #f9f7f3;
            border-radius: var(--border-radius);
            text-align: center;
            display: none;
            border: 2px solid var(--light-brown);
            position: relative;
            z-index: 1;
        }
        
        .results.show {
            display: block;
        }
        
        .score {
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark-brown);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        
        .score-value {
            font-size: 3.5rem;
            color: var(--primary-brown);
        }
        
        .results-message {
            font-size: 1.8rem;
            margin-bottom: 25px;
            padding: 15px;
            border-radius: var(--border-radius);
            position: relative;
            z-index: 1;
        }
        
        .answer-key {
            margin-top: 30px;
            text-align: left;
            position: relative;
            z-index: 1;
        }
        
        .answer-key h4 {
            margin-bottom: 15px;
            color: var(--dark-brown);
            font-size: 1.5rem;
            text-align: center;
        }
        
        .answer-list {
            list-style-type: none;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .answer-list li {
            padding: 12px;
            background-color: white;
            border-radius: var(--border-radius);
            border: 1px solid var(--light-brown);
            font-size: 1.3rem;
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--light-brown);
            color: var(--secondary-brown);
            font-size: 1.1rem;
            position: relative;
            z-index: 1;
        }
        
        /* Watermark footer (giống 17tlsbt) */
        footer::before {
            content: "tuibx";
            position: absolute;
            bottom: 10px;
            right: 20px;
            font-size: 1rem;
            color: rgba(139, 69, 19, 0.3);
            font-weight: bold;
            font-style: italic;
            z-index: 0;
        }
        
        /* Thêm watermark phủ toàn màn hình (giống 17tlsbt) */
        .watermark-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9998;
        }
        
        .watermark-overlay::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://cdn.jsdelivr.net/gh/tuibx25/images/bx/tuibx.png');
            background-repeat: repeat;
            background-position: center;
            background-size: 200px 200px;
            opacity: 0.04;
        }
        
        /* Responsive cho điện thoại */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
                background-color: rgba(255, 255, 255, 0.95);
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .question {
                padding: 20px;
            }
            
            .question-text {
                font-size: 1.3rem;
            }
            
            .option-text {
                font-size: 1.3rem;
            }
            
            .explanation p {
                font-size: 1.3rem;
            }
            
            button {
                width: 100%;
                min-width: auto;
                padding: 16px;
            }
            
            .controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .answer-list {
                grid-template-columns: 1fr;
            }
            
            .score {
                font-size: 1.8rem;
            }
            
            .score-value {
                font-size: 2.8rem;
            }
            
            .results-message {
                font-size: 1.5rem;
            }
            
            body::before {
                background-size: 300px 300px;
                opacity: 0.05;
            }
            
            .question::before {
                width: 200px;
                height: 200px;
            }
        }
        
        /* Tối ưu cho TV/trình chiếu lớn */
        @media (min-width: 1200px) {
            .question-text, .option-text, .explanation p, .instructions p {
                font-size: 1.8rem;
            }
            
            h1 {
                font-size: 3rem;
            }
            
            .subtitle {
                font-size: 1.6rem;
            }
            
            button {
                font-size: 1.6rem;
                padding: 22px 40px;
            }
            
            .question-number {
                width: 50px;
                height: 50px;
                line-height: 50px;
                font-size: 1.5rem;
            }
            
            .option-letter {
                width: 45px;
                height: 45px;
                line-height: 45px;
                font-size: 1.3rem;
            }
            
            .score {
                font-size: 2.5rem;
            }
            
            .score-value {
                font-size: 4rem;
            }
            
            .results-message {
                font-size: 2rem;
            }
            
            body::before {
                background-size: 500px 500px;
                opacity: 0.1;
            }
        }
        
        /* Đảm bảo MathJax hiển thị đúng */
        .MathJax_SVG {
            display: inline !important;
        }
        
        mjx-container[jax="SVG"] {
            display: inline-block !important;
        }
    </style>
</head>
<body>
    <!-- Watermark phủ toàn màn hình (giống 17tlsbt) -->
    <div class="watermark-overlay"></div>
    
    <div class="container">
        <header>
            <h1>Bài Tập Trắc Nghiệm - Bài 17 (SBT)</h1>
            <p class="subtitle">KHÁI NIỆM ĐIỆN TRƯỜNG</p>
            <p class="chapter-info">Vật Lý 11 - Sách Bài Tập</p>
        </header>
        <div class="quiz-container" id="quizContainer">
            <!-- Các câu hỏi sẽ được tạo bằng JavaScript -->
        </div>
        
        <div class="controls">
            <button id="checkBtn">KIỂM TRA KẾT QUẢ</button>
            <button id="resetBtn">LÀM LẠI</button>
        </div>
        
        <div class="results" id="resultsContainer">
            <div class="score">Điểm của bạn: <span class="score-value" id="scoreValue">0/10</span></div>
            <div class="results-message" id="resultsMessage"></div>
            <div class="answer-key">
                <h4>Đáp án chính xác:</h4>
                <ul class="answer-list" id="answerList"></ul>
            </div>
        </div>
        
        <footer>
            <p>Bài tập trắc nghiệm Vật Lý 11 - Bài 17: Khái niệm điện trường</p>
        </footer>
    </div>

    <script>
        // Dữ liệu câu hỏi
        const questions = [
            {
                text: "Điện trường được tạo ra bởi điện tích, là dạng vật chất tồn tại quanh điện tích và",
                options: [
                    "A. tác dụng lực lên mọi vật đặt trong nó.",
                    "B. tác dụng lực điện lên mọi vật đặt trong nó.",
                    "C. truyền lực cho các điện tích.",
                    "D. truyền tương tác giữa các điện tích."
                ],
                correct: 3,
                explanation: "Điện trường là môi trường truyền tương tác giữa các điện tích, là dạng vật chất tồn tại xung quanh điện tích. Đáp án đúng là D."
            },
            {
                text: "Cường độ điện trường tại một điểm đặc trưng cho điện trường tại điểm đó về",
                options: [
                    "A. phương của vectơ cường độ điện trường.",
                    "B. chiều của vectơ cường độ điện trường.",
                    "C. phương diện tác dụng lực.",
                    "D. độ lớn của lực điện."
                ],
                correct: 2,
                explanation: "Cường độ điện trường đặc trưng cho khả năng tác dụng lực của điện trường tại điểm đó. Đáp án đúng là C."
            },
            {
                text: "Đơn vị của cường độ điện trường là",
                options: [
                    "A. N.",
                    "B. N/m.",
                    "C. V/m.",
                    "D. J/C."
                ],
                correct: 2,
                explanation: "Đơn vị của cường độ điện trường E là V/m (volt/mét), tương đương với N/C (newton/coulomb). Đáp án đúng là C."
            },
            {
                text: "Đại lượng nào dưới đây không liên quan tới cường độ điện trường của một điện tích điểm Q đặt tại một điểm trong chân không?",
                options: [
                    "A. Khoảng cách r từ Q đến điểm quan sát.",
                    "B. Hằng số điện của chân không.",
                    "C. Độ lớn của điện tích Q.",
                    "D. Độ lớn của điện tích Q đặt tại điểm quan sát."
                ],
                correct: 3,
                explanation: "Cường độ điện trường do Q gây ra tại một điểm chỉ phụ thuộc vào bản thân Q và khoảng cách từ Q đến điểm đó, không phụ thuộc vào điện tích đặt tại điểm quan sát. Đáp án đúng là D."
            },
            {
                text: "Một điện tích điểm Q < 0 đặt trong chân không. Cường độ điện trường do điện tích Q gây ra tại một điểm M cách Q một khoảng r có phương là đường thẳng nối Q với M và",
                options: [
                    `A. chiều hướng từ M tới Q với độ lớn bằng \\(\\frac{|Q|}{4\\pi\\epsilon_0 r^2}\\).`,
                    `B. chiều hướng từ M ra xa khỏi Q với độ lớn bằng \\(\\frac{|Q|}{4\\pi\\epsilon_0 r^2}\\).`,
                    `C. chiều hướng từ M tới Q với độ lớn bằng \\(\\frac{-Q}{4\\pi\\epsilon_0 r^2}\\).`,
                    `D. chiều hướng từ M ra xa khỏi Q với độ lớn bằng \\(\\frac{-Q}{4\\pi\\epsilon_0 r^2}\\).`
                ],
                correct: 0,
                explanation: "Với Q < 0, vectơ cường độ điện trường E hướng vào Q (từ M tới Q). Độ lớn luôn dương: \\(E = \\frac{|Q|}{4\\pi\\epsilon_0 r^2}\\). Đáp án đúng là A."
            },
            {
                text: "Trong chân không đặt cố định một điện tích điểm Q = 2·10⁻¹³ C. Cường độ điện trường tại một điểm M cách Q một khoảng 2 cm có giá trị bằng",
                options: [
                    "A. 2,25 V/m.",
                    "B. 4,5 V/m.",
                    "C. 2,25·10⁻⁴ V/m.",
                    "D. 4,5·10⁻⁴ V/m."
                ],
                correct: 1,
                explanation: `Áp dụng công thức: \\(E = \\frac{k|Q|}{r^2} = \\frac{9\\times10^9 \\times 2\\times10^{-13}}{(0.02)^2} = \\frac{1.8\\times10^{-3}}{4\\times10^{-4}} = 4.5 \\ \\text{V/m}\\). Đáp án đúng là B.`
            },
            {
                text: "Trong chân không đặt cố định một điện tích điểm Q. Một điểm M cách Q một khoảng r. Tập hợp những điểm có độ lớn cường độ điện trường bằng độ lớn cường độ điện trường tại M là",
                options: [
                    "A. mặt cầu tâm Q và đi qua M.",
                    "B. một đường tròn đi qua M.",
                    "C. một mặt phẳng đi qua M.",
                    "D. các mặt cầu đi qua M."
                ],
                correct: 0,
                explanation: "Với điện tích điểm, E chỉ phụ thuộc khoảng cách r đến Q. Các điểm cách Q cùng khoảng cách r tạo thành mặt cầu tâm Q bán kính r. Đáp án đúng là A."
            },
            {
                text: "Cường độ điện trường tại một điểm M trong điện trường bất kì là đại lượng",
                options: [
                    "A. vectơ, có phương, chiều và độ lớn phụ thuộc vào vị trí của điểm M.",
                    "B. vectơ, chỉ có độ lớn phụ thuộc vào vị trí của điểm M."
                ],
                correct: 0,
                explanation: "Cường độ điện trường E là một đại lượng vectơ, có cả phương, chiều và độ lớn, tất cả đều phụ thuộc vào vị trí điểm M trong điện trường. Đáp án đúng là A."
            },
            {
                text: "Những đường sức điện của điện trường xung quanh một điện tích điểm Q < 0 có dạng là",
                options: [
                    "A. những đường cong và đường thẳng có chiều đi vào điện tích Q.",
                    "B. những đường thẳng có chiều đi vào điện tích Q.",
                    "C. những đường cong và đường thẳng có chiều đi ra khỏi điện tích Q.",
                    "D. những đường thẳng có chiều đi ra khỏi điện tích Q."
                ],
                correct: 1,
                explanation: "Với điện tích điểm đơn lẻ, đường sức điện là những đường thẳng xuyên tâm. Q < 0 nên đường sức hướng vào Q. Đáp án đúng là B."
            },
            {
                text: "Đường sức điện cho chúng ta biết về",
                options: [
                    "A. độ lớn của cường độ điện trường của các điểm trên đường sức điện.",
                    "B. phương và chiều của cường độ điện trường tại mỗi điểm trên đường sức điện.",
                    "C. độ lớn của lực điện tác dụng lên điện tích thứ q.",
                    "D. độ mạnh yếu của điện trường."
                ],
                correct: 1,
                explanation: "Đường sức điện cho biết phương và chiều của vectơ cường độ điện trường tại mỗi điểm trên đường sức. Đáp án đúng là B."
            }
        ];

        // Biến toàn cục
        let userAnswers = Array(questions.length).fill(null);
        let quizSubmitted = false;

        // ========== CHỨC NĂNG TRẮC NGHIỆM ==========
        // Khởi tạo bài trắc nghiệm
        function initializeQuiz() {
            const quizContainer = document.getElementById('quizContainer');
            quizContainer.innerHTML = '';
            
            questions.forEach((question, index) => {
                const questionElement = document.createElement('div');
                questionElement.className = 'question';
                questionElement.dataset.index = index;
                
                questionElement.innerHTML = `
                    <div class="question-header">
                        <span class="question-number">${index + 1}</span>
                        <span class="question-text">${question.text}</span>
                    </div>
                    <div class="options">
                        ${question.options.map((option, optIndex) => `
                            <div class="option" data-option="${optIndex}">
                                <div class="option-letter">${String.fromCharCode(65 + optIndex)}</div>
                                <div class="option-text">${option}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="explanation" id="explanation${index}">
                        <h4>Giải thích:</h4>
                        <p>${question.explanation}</p>
                    </div>
                `;
                
                quizContainer.appendChild(questionElement);
                
                // Thêm sự kiện click cho các lựa chọn
                const optionElements = questionElement.querySelectorAll('.option');
                optionElements.forEach(option => {
                    option.addEventListener('click', () => {
                        if (quizSubmitted) return;
                        
                        const questionIndex = parseInt(questionElement.dataset.index);
                        const optionIndex = parseInt(option.dataset.option);
                        
                        // Xóa lựa chọn trước đó
                        optionElements.forEach(opt => opt.classList.remove('selected'));
                        
                        // Đánh dấu lựa chọn mới
                        option.classList.add('selected');
                        
                        // Lưu câu trả lời của người dùng
                        userAnswers[questionIndex] = optionIndex;
                    });
                });
            });
            
            // Reset biến
            quizSubmitted = false;
            document.getElementById('resultsContainer').classList.remove('show');
            
            // Render lại MathJax sau khi tải xong nội dung
            setTimeout(() => {
                if (window.MathJax) {
                    window.MathJax.typeset();
                }
            }, 100);
        }

        // Kiểm tra kết quả
        function checkAnswers() {
            let correctCount = 0;
            
            questions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const correctAnswer = question.correct;
                const questionElement = document.querySelector(`.question[data-index="${index}"]`);
                const explanationElement = document.getElementById(`explanation${index}`);
                
                // Hiển thị giải thích
                explanationElement.classList.add('show');
                
                // Đánh dấu đáp án đúng/sai
                const options = questionElement.querySelectorAll('.option');
                
                // Đánh dấu đáp án đúng
                options[correctAnswer].classList.add('correct');
                
                // Đánh dấu đáp án sai nếu người dùng chọn sai
                if (userAnswer !== null && userAnswer !== correctAnswer) {
                    options[userAnswer].classList.add('incorrect');
                }
                
                // Đếm số câu đúng
                if (userAnswer === correctAnswer) {
                    correctCount++;
                }
            });
            
            // Hiển thị kết quả
            showResults(correctCount);
            quizSubmitted = true;
            
            // Render lại MathJax sau khi hiển thị giải thích
            setTimeout(() => {
                if (window.MathJax) {
                    window.MathJax.typeset();
                }
            }, 300);
        }

        // Hiển thị kết quả
        function showResults(correctCount) {
            const scoreValue = document.getElementById('scoreValue');
            const resultsMessage = document.getElementById('resultsMessage');
            const answerList = document.getElementById('answerList');
            
            // Tính điểm
            const score = correctCount;
            const total = questions.length;
            const percentage = Math.round((correctCount / total) * 100);
            
            scoreValue.textContent = `${score}/${total}`;
            
            // Thông báo kết quả
            if (percentage >= 80) {
                resultsMessage.textContent = "Xuất sắc! Bạn đã nắm vững kiến thức về điện trường.";
                resultsMessage.style.color = "var(--correct-color)";
            } else if (percentage >= 60) {
                resultsMessage.textContent = "Khá tốt! Bạn hiểu khá rõ về điện trường.";
                resultsMessage.style.color = "var(--secondary-brown)";
            } else if (percentage >= 40) {
                resultsMessage.textContent = "Cần cố gắng thêm! Hãy xem lại lý thuyết về điện trường.";
                resultsMessage.style.color = "var(--dark-brown)";
            } else {
                resultsMessage.textContent = "Cần ôn tập lại! Bạn nên xem kỹ lại bài học về điện trường.";
                resultsMessage.style.color = "var(--incorrect-color)";
            }
            
            // Hiển thị đáp án
            answerList.innerHTML = '';
            questions.forEach((question, index) => {
                const listItem = document.createElement('li');
                const correctAnswer = String.fromCharCode(65 + question.correct);
                listItem.innerHTML = `<strong>Câu ${index + 1}:</strong> ${correctAnswer}`;
                answerList.appendChild(listItem);
            });
            
            // Hiển thị kết quả
            document.getElementById('resultsContainer').classList.add('show');
            
            // Cuộn đến kết quả
            document.getElementById('resultsContainer').scrollIntoView({ behavior: 'smooth' });
        }

        // Reset bài trắc nghiệm
        function resetQuiz() {
            userAnswers = Array(questions.length).fill(null);
            initializeQuiz();
            
            // Cuộn lên đầu trang
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Gán sự kiện cho nút
        document.getElementById('checkBtn').addEventListener('click', checkAnswers);
        document.getElementById('resetBtn').addEventListener('click', resetQuiz);

        // Khởi tạo bài trắc nghiệm khi tải trang
        window.addEventListener('DOMContentLoaded', initializeQuiz);
        
        // Cấu hình MathJax
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            },
            startup: {
                pageReady: () => {
                    return MathJax.startup.defaultPageReady().then(() => {
                        console.log('MathJax đã sẵn sàng');
                    });
                }
            }
        };
    </script>
</body>
</html>